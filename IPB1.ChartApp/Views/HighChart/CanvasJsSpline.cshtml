@using IPB1.ChartApp.Controllers
@using Newtonsoft.Json
@model List<SimpleChartDto>

<div id="canvasjsContainer" style="height: 370px; width: 100%;"></div>

@section scripts {
    <script src="https://cdn.canvasjs.com/canvasjs.min.js"></script>

    <script>
        const _rawData = @Html.Raw(JsonConvert.SerializeObject(Model));

        // CanvasJS expects dataPoints with { label: "", y: number } format
        // Our DTO uses "Label" and "Value", so we map it.
        const dataPoints = _rawData.map(item => {
            return { label: item.Label, y: item.Value };
        });

        var chart = new CanvasJS.Chart("canvasjsContainer", {
            animationEnabled: true,
            title: {
                text: "Weekly Temperature"
            },
            axisY: {
                title: "Temperature (°C)",
                suffix: " °C"
            },
            data: [{
                type: "splineArea",
                markerSize: 5,
                xValueFormatString: "YYYY",
                yValueFormatString: "#,##0.## °C",
                dataPoints: dataPoints
            }]
        });
        chart.render();
    </script>
}